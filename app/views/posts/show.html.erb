<div class='mt-3 p-2 bg-light rounded shadow-sm d-flex'>
  <div class='btn-group-vertical btn-group-sm'>
    <%= link_to '+', upvote_post_path(@post), method: :put, class: 'badge badge-light w-100' %>
    <span class='badge badge-light w-100'><%= @post.weighted_score %></span>
    <%= link_to '-', downvote_post_path(@post), method: :put, class: 'badge badge-light w-100' %>
  </div>
  <div class='mx-2 text-justify'><%= @post.content %></div>
</div>

<div class='row my-2'>
  <div class='col'>
    <small>
      Posted by <%= link_to @post.user.username, @post.user %>
      <%= time_ago_in_words(@post.created_at) %> ago
    </small>
  </div>
  <% if can? :manage, @post %>
    <div class='col-2'>
      <%= link_to 'edit', edit_post_path(@post), class: 'badge badge-light font-weight-light float-right' %>
      <%= link_to 'delete', @post, method: :delete, data: { confirm: 'Are you sure?' }, class: 'badge badge-light font-weight-light float-right' %>
    </div>
  <% end %>
</div>

<% if @comments.any? %>
  <h5 class='mt-2'>Comments</h5>
  <%= render 'shared/comments' %>
<% end %>


<h5 class='mt-2'>Add comment</h5>
<% if @post.errors.any? %>
  <div class="alert my-3 p-2 alert-danger">
    <h2><%= pluralize(@post.errors.count, "error") %> prohibited this comment from being saved:</h2>

    <ul>
    <% @post.errors.full_messages.each do |message| %>
      <li><%= message %></li>
    <% end %>
    </ul>
  </div>
<% end %>
<%= form_with(model: [@post, @post.comments.build], local: true) do |form| %>
  <div class="form-group">
    <%= form.text_area :content, class: "form-control",  rows: "5" %>
  </div>
  <div class="actions">
    <%= form.submit class: "btn btn-primary" %>
  </div>
<% end %>
